--- Day 8: Resonant Collinearity ---
You find yourselves on the roof of a top-secret Easter Bunny installation.

While The Historians do their thing, you take a look at the familiar huge antenna. Much to your surprise, it seems to have been reconfigured to emit a signal that makes people 0.1% more likely to buy Easter Bunny brand Imitation Mediocre Chocolate as a Christmas gift! Unthinkable!

Scanning across the city, you find that there are actually many such antennas. Each antenna is tuned to a specific frequency indicated by a single lowercase letter, uppercase letter, or digit. You create a map (your puzzle input) of these antennas. For example:

............
........0...
.....0......
.......0....
....0.......
......A.....
............
............
........A...
.........A..
............
............
The signal only applies its nefarious effect at specific antinodes based on the resonant frequencies of the antennas. In particular, an antinode occurs at any point that is perfectly in line with two antennas of the same frequency - but only when one of the antennas is twice as far away as the other. This means that for any pair of antennas with the same frequency, there are two antinodes, one on either side of them.

So, for these two antennas with frequency a, they create the two antinodes marked with #:

..........
...#......
..........
....a.....
..........
.....a....
..........
......#...
..........
..........
Adding a third antenna with the same frequency creates several more antinodes. It would ideally add four antinodes, but two are off the right side of the map, so instead it adds only two:

..........
...#......
#.........
....a.....
........a.
.....a....
..#.......
......#...
..........
..........
Antennas with different frequencies don't create antinodes; A and a count as different frequencies. However, antinodes can occur at locations that contain antennas. In this diagram, the lone antenna with frequency capital A creates no antinodes but has a lowercase-a-frequency antinode at its location:

..........
...#......
#.........
....a.....
........a.
.....a....
..#.......
......A...
..........
..........
The first example has antennas with two different frequencies, so the antinodes they create look like this, plus an antinode overlapping the topmost A-frequency antenna:

......#....#
...#....0...
....#0....#.
..#....0....
....0....#..
.#....A.....
...#........
#......#....
........A...
.........A..
..........#.
..........#.
Because the topmost A-frequency antenna overlaps with a 0-frequency antinode, there are 14 total unique locations that contain an antinode within the bounds of the map.

Calculate the impact of the signal. How many unique locations within the bounds of the map contain an antinode?

--- Part Two ---
Watching over your shoulder as you work, one of The Historians asks if you took the effects of resonant harmonics into your calculations.

Whoops!

After updating your model, it turns out that an antinode occurs at any grid position exactly in line with at least two antennas of the same frequency, regardless of distance. This means that some of the new antinodes will occur at the position of each antenna (unless that antenna is the only one of its frequency).

So, these three T-frequency antennas now create many antinodes:

T....#....
...T......
.T....#...
.........#
..#.......
..........
...#......
..........
....#.....
..........
In fact, the three T-frequency antennas are all exactly in line with two antennas, so they are all also antinodes! This brings the total number of antinodes in the above example to 9.

The original example now has 34 antinodes, including the antinodes that appear on every antenna:

##....#....#
.#.#....0...
..#.#0....#.
..##...0....
....0....#..
.#...#A....#
...#..#.....
#....#.#....
..#.....A...
....#....A..
.#........#.
...#......##
Calculate the impact of the signal using this updated model. How many unique locations within the bounds of the map contain an antinode?
---------------------------------------------------

--- 8日目： 共鳴コリニアリティ ---
あなたは、最高機密のイースターバニーの施設の上部屋の屋根にいます。
歴史家たちが調査をしている間、あなたは見慣れた巨大なアンテナを眺めます。驚いたことに、そのアンテナは再構成され、人々がイースターバニーのブランドである「イミテーション・メディオアー（Imitation Mediocre）チョコレート」をクリスマスプレゼントとして購入する可能性を0.1%高めるような信号を発信するように設定されているようです。信じられない！
街中をスキャンしてみると、実際にはこのようなアンテナが数多くあることがわかります。各アンテナは、小文字、大文字、数字の1文字で示される特定の周波数に調整されています。あなたはこれらのアンテナのマップ（パズルの入力）を作成します。例えば：............
........
0........
0.............
0........
0.............
A.................
............
........
A............
A..............
............
信号は、アンテナの共振周波数に基づいて特定の反ノードにおいてのみ悪影響を及ぼします。特に、反ノードは、同じ周波数の2本のアンテナと完全に一直線上にある地点で発生しますが、ただし、一方のアンテナが他方の2倍の距離にある場合に限ります。つまり、同じ周波数のアンテナのペアには、それぞれ両側に2つの反ノードがあるということです。
したがって、周波数aの2本のアンテナでは、#でマークされた2つの反ノードが形成されます。:......
...
#............
...
a............
...
a............
......
#............
......

同じ周波数の3本目のアンテナを追加すると、さらにいくつかの反ノードが形成されます。理想的には4つの反ノードが追加されるはずですが、2つはマップの右側から外れているため、代わりに2つだけが追加されます。......
...
#......
#.............
a.............
a......
a......
#.............
#.............
..........

異なる周波数のアンテナは反ノードを作りません。
A
と
a
は異なる周波数として数えられます。しかし、反ノードはアンテナが存在する場所で発生する可能性があります。この図では、大文字の
A
の周波数を持つアンテナが1つだけあり、反ノードは作りませんが、小文字の
a
の周波数を持つ反ノードがその場所に存在します。
...#......
#.............
a.............
a......
a......
#.............
A.............
..........

最初の例では、2つの異なる周波数のアンテナが存在するため、それらが作り出す反ノードは次のようになります。さらに、最上部のA周波数アンテナと重なる反ノードもあります。......
#....#...
#....0.......
#0....#...
#....0........
0....#..
.#....A........
#........
#......#............
A............
A............
#...........
#.
最上部のA周波数アンテナが0周波数反ノードと重なっているため、地図の範囲内に反ノードが含まれるユニークな場所は合計14箇所あります。
信号の影響を計算します。地図の範囲内に反ノードが含まれるユニークな場所はいくつありますか？

--- パート2 ---
作業中に肩越しに様子を見ていると、歴史家の一人が、共鳴高調波の影響を計算に組み込んだかどうか尋ねてきました。
おっと！
モデルを更新したところ、距離に関係なく、同じ周波数の少なくとも2本のアンテナと正確に一直線上に、どのグリッド位置でも反ノードが発生することが判明しました。つまり、新しい反ノードのいくつかは、各アンテナの位置で発生することになります（そのアンテナが同じ周波数のアンテナが1本しかない場合を除く）。
したがって、これら3本のT周波数アンテナは、現在、多くの反ノードを発生させています。
T...#......
T....
T...#...
...#..
#.................
...
#................
....
#...............

実際には、3本のT周波数アンテナは2本のアンテナと完全に一直線上に並んでいるため、これらもすべて反ノードとなります。これにより、上記の例における反ノードの総数は9つとなります。
元の例では、反ノードは34つとなり、すべてのアンテナに現れる反ノードを含めると次のようになります。
##....#....#.
#.#....0.....
#.#0....#...
##...0........
0....#...
#...#A....#...
#..#.....
#....#.#......
#.....A.......
#....A...
#........#....
#......##
この更新されたモデルを使用して、信号の影響を計算します。地図の範囲内に、どのくらいの数のユニークな場所に反転点が含まれていますか？